
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="...to my playground, which was originally created to find out more about the possibilities when using GitHub-Repos  with Azure-DevOps to run YAML based Azure-Pipelines, as well as the differences compared to the use of Azure-Repos. Meanwhile I also begun using Jira to track Issues and Features and it's integrated Service-Desk to have a Place for Bug reports or feature suggestions. Feel free to compare it to the newly available GitHub Issue Templates, which imho are also a very good approach when you need to support your user base. I also started to play around with Jfrog's Artifactory which is a great option to find vulnerabilities or supply container images, to name just a few of it's features.
So as u see, there is already a lot going on here and it's not getting boring at all">
      
      
        <meta name="author" content="mauwii">
      
      
        <link rel="canonical" href="https://mauwii.github.io/azure-pipelines-with-github-repo/get-rid-of-stable-branch.381/workflow/2-azure-pipelines/">
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.8">
    
    
      
        <title>Azure-Pipelines - Azure-Pipelines with GitHub-Repo</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25 0 0 1 .25-.25h5.025a.25.25 0 0 1 .177.073l6.25 6.25a.25.25 0 0 1 0 .354l-5.025 5.025a.25.25 0 0 1-.354 0l-6.25-6.25a.25.25 0 0 1-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775zM6 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 0 1 .25-.25h8.5a.25.25 0 0 1 .25.25v7.736a.75.75 0 1 0 1.5 0V1.75A1.75 1.75 0 0 0 11.25 0h-8.5A1.75 1.75 0 0 0 1 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 0 0 0-1.5H2.75a.25.25 0 0 1-.25-.25V1.75zM4.75 4a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-4.5zM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75zm11.774 3.537a.75.75 0 0 0-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 0 0-1.062 1.058l1.943 1.95a.75.75 0 0 0 1.055.008l4.557-4.45z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm6.5-.25A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75zM8 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.489 4.489 0 0 1-.563-1.191 3.833 3.833 0 0 1-.05-2.063 4.636 4.636 0 0 1-2.025-.293.75.75 0 1 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.748.748 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.404 2.404 0 0 1-.507-.441 3.063 3.063 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.753.753 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768a85.08 85.08 0 0 0-.317-.265c-.814-.68-1.75-1.462-2.692-2.619a3.74 3.74 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 1.06-1.06L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm9 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM6.92 6.085c.081-.16.19-.299.34-.398.145-.097.371-.187.74-.187.28 0 .553.087.738.225A.613.613 0 0 1 9 6.25c0 .177-.04.264-.077.318a.956.956 0 0 1-.277.245c-.076.051-.158.1-.258.161l-.007.004a7.728 7.728 0 0 0-.313.195 2.416 2.416 0 0 0-.692.661.75.75 0 0 0 1.248.832.956.956 0 0 1 .276-.245 6.3 6.3 0 0 1 .26-.16l.006-.004c.093-.057.204-.123.313-.195.222-.149.487-.355.692-.662.214-.32.329-.702.329-1.15 0-.76-.36-1.348-.863-1.725A2.76 2.76 0 0 0 8 4c-.631 0-1.155.16-1.572.438-.413.276-.68.638-.849.977a.75.75 0 1 0 1.342.67z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575L6.457 1.047zM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-.25-5.25a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 0 1.5 0v-2.5z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.404 12.596a6.5 6.5 0 1 1 9.192-9.192 6.5 6.5 0 0 1-9.192 9.192zM2.344 2.343a8 8 0 1 0 11.313 11.314A8 8 0 0 0 2.343 2.343zM6.03 4.97a.75.75 0 0 0-1.06 1.06L6.94 8 4.97 9.97a.75.75 0 1 0 1.06 1.06L8 9.06l1.97 1.97a.75.75 0 1 0 1.06-1.06L9.06 8l1.97-1.97a.75.75 0 1 0-1.06-1.06L8 6.94 6.03 4.97z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 0 0-.01.004L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.02.02 0 0 0-.004-.009.02.02 0 0 0-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.492 3.492 0 0 1 2.441 0l.999-1a.75.75 0 1 1 1.06 1.061l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.013 5.013 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.684 1.684 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06zM6.173 5h3.654A.173.173 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173zM5.25 6.5a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75h-5.5z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458L5 5.782zM9.5 2.5h-3V6a.75.75 0 0 1-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6V2.5zm-6.9 9.847L3.775 10.5h8.45l1.175 1.847a.75.75 0 0 1-.633 1.153H3.233a.75.75 0 0 1-.633-1.153z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 2.5a.75.75 0 0 0 0 1.5h10.5a.75.75 0 0 0 0-1.5H1.75zm4 5a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5zm0 5a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5zM2.5 7.75a.75.75 0 0 0-1.5 0v6a.75.75 0 0 0 1.5 0v-6z"/></svg>');}</style>

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/version-select.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#azure-pipelinesyml" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Azure-Pipelines with GitHub-Repo" class="md-header__button md-logo" aria-label="Azure-Pipelines with GitHub-Repo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Azure-Pipelines with GitHub-Repo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Azure-Pipelines
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="dark-blue" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Mauwii/azure-pipelines-with-github-repo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Mauwii/azure-pipelines-with-github-repo
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../todo/" class="md-tabs__link">
      ToDo
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../1-repository/" class="md-tabs__link md-tabs__link--active">
        Workflow
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Azure-Pipelines with GitHub-Repo" class="md-nav__button md-logo" aria-label="Azure-Pipelines with GitHub-Repo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Azure-Pipelines with GitHub-Repo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Mauwii/azure-pipelines-with-github-repo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Mauwii/azure-pipelines-with-github-repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../todo/" class="md-nav__link">
        ToDo
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../reference/">Reference</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/diagrams/" class="md-nav__link">
        Diagrams
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Workflow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Workflow" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Workflow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1-repository/" class="md-nav__link">
        Repository
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Azure-Pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Azure-Pipelines
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#azure-pipelinesyml" class="md-nav__link">
    azure-pipelines.yml
  </a>
  
    <nav class="md-nav" aria-label="azure-pipelines.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mainyml" class="md-nav__link">
    main.yml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bicep_stageyml" class="md-nav__link">
    bicep_stage.yml
  </a>
  
    <nav class="md-nav" aria-label="bicep_stage.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bicep_stepsyml" class="md-nav__link">
    bicep_steps.yml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_resourcegroupyml" class="md-nav__link">
    create_resourceGroup.yml
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkdocs-material" class="md-nav__link">
    mkdocs-material
  </a>
  
    <nav class="md-nav" aria-label="mkdocs-material">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build_mkdocsyml" class="md-nav__link">
    build_mkdocs.yml
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devopsbuildagentyml" class="md-nav__link">
    devopsbuildagent.yml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup_automationyml" class="md-nav__link">
    cleanup_automation.yml
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/Mauwii/azure-pipelines-with-github-repo/edit/main/docs/workflow/2-azure-pipelines.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>Azure-Pipelines</h1>

<h3 id="azure-pipelinesyml">azure-pipelines.yml<a class="headerlink" href="#azure-pipelinesyml" title="Permanent link">&para;</a></h3>
<p>This is the YAML File which defined the main Pipeline while this Docs your are reading have been deployed. Most Parts of it are referencing Templates which are located bellow the subfolder <code>/azure-pipelines</code>.</p>
<p>I had the Idea to use this folder for pipeline Stage-Templates, then use the <code>azure-pipelines/jobs</code> subfolder for job-templates and finally a subfolder <code>azure-pipelines/jobs/steps</code> for, you guessed it, step-templates. But at the moment I am thinking to have another subfolder-stage <code>azure-pipelines/stages/jobs/steps</code>, and store pipelines directly in <code>azure-pipelines</code>, which atm are stored in <code>azure-pipelines/triggers</code> which feels kind of wrong.</p>
<details class="quote">
<summary>azure-pipelines.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nt">trigger</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="nt">batch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="nt">branches</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nt">include</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">refs/heads/main</span><span class="w"></span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">refs/heads/stable</span><span class="w"></span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="nt">pr</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span><span class="w"></span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="nt">resources</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">  </span><span class="nt">repositories</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">self</span><span class="w"></span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">      </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mauwii</span><span class="w"></span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="nt">variables</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/variables/default.yml</span><span class="w"></span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ if in(variables[&#39;Build.SourceBranch&#39;], &#39;refs/heads/main&#39;, &#39;refs/heads/stable&#39;) }}</span><span class="p p-Indicator">:</span><span class="w"></span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/variables/${{ variables[&#39;Build.SourceBranchName&#39;] }}.yml</span><span class="w"></span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepDir</span><span class="w"></span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Directory containing Folders with Bicep Templates</span><span class="w"></span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;$(bicepDir)&#39;</span><span class="w"></span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepParameter</span><span class="w"></span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Used in some templates to change Resource Name or other variables</span><span class="w"></span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stg</span><span class="w"></span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span><span class="w"></span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourceGroupName</span><span class="w"></span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the Resource Group where templates will be deployed to</span><span class="w"></span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;$(resourceGroupName)&#39;</span><span class="w"></span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azureSubscription</span><span class="w"></span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the ARM-Service Connection</span><span class="w"></span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;$(azureSubscription)&#39;</span><span class="w"></span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span><span class="w"></span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location where the Resources will be deployed</span><span class="w"></span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(location)</span><span class="w"></span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agentpool</span><span class="w"></span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Agent-Pool to be used</span><span class="w"></span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="w"></span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="nt">extends</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/stages/main.yml</span><span class="w"></span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">  </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="nt">bicepDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepDir }}</span><span class="w"></span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="nt">bicepParameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepParameter }}</span><span class="w"></span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.resourceGroupName }}</span><span class="w"></span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.location }}</span><span class="w"></span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="nt">agentpool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.agentpool }}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h4 id="mainyml">main.yml<a class="headerlink" href="#mainyml" title="Permanent link">&para;</a></h4>
<p>This stage-template contains is defining the complete pipeline. I had it separated from <code>azure-pipelines.yml</code> to be able to run <code>validate_pr.yml</code> (pull request validation) with the same stages than <code>azure-pipelines.yml</code>, but after development moved on I got rid of <code>validate_pr.yml</code> but thought it could still be practical later on to have this <code>main.yml</code> template.</p>
<details class="quote">
<summary>azure-pipelines/main.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepDir</span><span class="w"></span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Directory containing Folders with Bicep Templates</span><span class="w"></span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IaC/bicep/deploy</span><span class="w"></span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepParameter</span><span class="w"></span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Used in some templates to change Resource Name or other variables</span><span class="w"></span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stg</span><span class="w"></span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span><span class="w"></span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourceGroupName</span><span class="w"></span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the Resource Group where templates will be deployed to</span><span class="w"></span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(resourceGroupName)</span><span class="w"></span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azureSubscription</span><span class="w"></span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the ARM-Service Connection</span><span class="w"></span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(azureSubscription)</span><span class="w"></span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span><span class="w"></span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location where the Resources will be deployed to</span><span class="w"></span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;westeurope&#39;</span><span class="w"></span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agentpool</span><span class="w"></span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Agent-Pool to be used</span><span class="w"></span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="w"></span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="nt">stages</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicep_stage.yml</span><span class="w"></span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a><span class="w">    </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="w">      </span><span class="nt">bicepDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepDir }}</span><span class="w"></span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="w">      </span><span class="nt">bicepParameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepParameter }}</span><span class="w"></span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="w">      </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.resourceGroupName }}</span><span class="w"></span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a><span class="w">      </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.location }}</span><span class="w"></span>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a><span class="w">      </span><span class="nt">agentpool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.agentpool }}</span><span class="w"></span>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ if in(variables[&#39;Build.SourceBranchName&#39;], &#39;main&#39;, &#39;stable&#39;) }}</span><span class="p p-Indicator">:</span><span class="w"></span>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cleanup.yml</span><span class="w"></span>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a><span class="w">        </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-46" name="__codelineno-1-46"></a><span class="w">          </span><span class="nt">agentpool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.agentpool }}</span><span class="w"></span>
<a id="__codelineno-1-47" name="__codelineno-1-47"></a><span class="w">          </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.resourceGroupName }}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h4 id="bicep_stageyml">bicep_stage.yml<a class="headerlink" href="#bicep_stageyml" title="Permanent link">&para;</a></h4>
<p>This stage is seperated in two jobs. where the first job is enumerating how often the second job needs to be run. Well, ok, this sounds a bit weird, but the secret is that it is not re-running the second job for x-times, but for every folder found in <code>IaC/bicep/deploy</code>. The steps which will then be done are found in the next section</p>
<details class="quote">
<summary>azure-pipelines/bicep_stage.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span>
<span class="normal"><a href="#__codelineno-2-41">41</a></span>
<span class="normal"><a href="#__codelineno-2-42">42</a></span>
<span class="normal"><a href="#__codelineno-2-43">43</a></span>
<span class="normal"><a href="#__codelineno-2-44">44</a></span>
<span class="normal"><a href="#__codelineno-2-45">45</a></span>
<span class="normal"><a href="#__codelineno-2-46">46</a></span>
<span class="normal"><a href="#__codelineno-2-47">47</a></span>
<span class="normal"><a href="#__codelineno-2-48">48</a></span>
<span class="normal"><a href="#__codelineno-2-49">49</a></span>
<span class="normal"><a href="#__codelineno-2-50">50</a></span>
<span class="normal"><a href="#__codelineno-2-51">51</a></span>
<span class="normal"><a href="#__codelineno-2-52">52</a></span>
<span class="normal"><a href="#__codelineno-2-53">53</a></span>
<span class="normal"><a href="#__codelineno-2-54">54</a></span>
<span class="normal"><a href="#__codelineno-2-55">55</a></span>
<span class="normal"><a href="#__codelineno-2-56">56</a></span>
<span class="normal"><a href="#__codelineno-2-57">57</a></span>
<span class="normal"><a href="#__codelineno-2-58">58</a></span>
<span class="normal"><a href="#__codelineno-2-59">59</a></span>
<span class="normal"><a href="#__codelineno-2-60">60</a></span>
<span class="normal"><a href="#__codelineno-2-61">61</a></span>
<span class="normal"><a href="#__codelineno-2-62">62</a></span>
<span class="normal"><a href="#__codelineno-2-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepDir</span><span class="w"></span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Directory containing Folders with Bicep Templates</span><span class="w"></span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepParameter</span><span class="w"></span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Used in some templates to change Resource Name or other variables</span><span class="w"></span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stg</span><span class="w"></span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span><span class="w"></span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourceGroupName</span><span class="w"></span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the Resource Group where templates will be deployed to</span><span class="w"></span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azureSubscription</span><span class="w"></span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the ARM-Service Connection</span><span class="w"></span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span><span class="w"></span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location where the Resources will be deployed to</span><span class="w"></span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agentpool</span><span class="w"></span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Agent-Pool to be used</span><span class="w"></span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="w"></span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="nt">stages</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicep</span><span class="w"></span>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bicep</span><span class="w"></span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="w">    </span><span class="nt">pool</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.agentpool }}</span><span class="w"></span>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">    </span><span class="nt">jobs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">getTemplateFolders</span><span class="w"></span>
<a id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">        </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get Template Folders</span><span class="w"></span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">        </span><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PowerShell@2</span><span class="w"></span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mtrx</span><span class="w"></span>
<a id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="w">            </span><span class="nt">env</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">              </span><span class="nt">bicepDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepDir }}</span><span class="w"></span>
<a id="__codelineno-2-41" name="__codelineno-2-41"></a><span class="w">              </span><span class="nt">bicepParameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.bicepParameter }}</span><span class="w"></span>
<a id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="w">              </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.resourceGroupName }}</span><span class="w"></span>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a><span class="w">              </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="w">              </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.location }}</span><span class="w"></span>
<a id="__codelineno-2-45" name="__codelineno-2-45"></a><span class="w">            </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-46" name="__codelineno-2-46"></a><span class="w">              </span><span class="nt">targetType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">filePath</span><span class="w"></span>
<a id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="w">              </span><span class="nt">filePath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scripts/New-BicepMatrix.ps1</span><span class="w"></span>
<a id="__codelineno-2-48" name="__codelineno-2-48"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runner</span><span class="w"></span>
<a id="__codelineno-2-49" name="__codelineno-2-49"></a><span class="w">        </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Test and Deploy</span><span class="w"></span>
<a id="__codelineno-2-50" name="__codelineno-2-50"></a><span class="w">        </span><span class="nt">dependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">getTemplateFolders</span><span class="w"></span>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a><span class="w">        </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">succeeded()</span><span class="w"></span>
<a id="__codelineno-2-52" name="__codelineno-2-52"></a><span class="w">        </span><span class="nt">strategy</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-53" name="__codelineno-2-53"></a><span class="w">          </span><span class="nt">matrix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[ dependencies.getTemplateFolders.outputs[&#39;mtrx.legs&#39;] ]</span><span class="w"></span>
<a id="__codelineno-2-54" name="__codelineno-2-54"></a><span class="w">          </span><span class="nt">maxParallel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<a id="__codelineno-2-55" name="__codelineno-2-55"></a><span class="w">        </span><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-56" name="__codelineno-2-56"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jobs/steps/bicep_steps.yml</span><span class="w"></span>
<a id="__codelineno-2-57" name="__codelineno-2-57"></a><span class="w">            </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-58" name="__codelineno-2-58"></a><span class="w">              </span><span class="nt">bicepDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)</span><span class="w"></span>
<a id="__codelineno-2-59" name="__codelineno-2-59"></a><span class="w">              </span><span class="nt">bicepTemplateDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a><span class="w">              </span><span class="nt">bicepParameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepParameter)</span><span class="w"></span>
<a id="__codelineno-2-61" name="__codelineno-2-61"></a><span class="w">              </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(resourceGroupName)</span><span class="w"></span>
<a id="__codelineno-2-62" name="__codelineno-2-62"></a><span class="w">              </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(azureSubscription)</span><span class="w"></span>
<a id="__codelineno-2-63" name="__codelineno-2-63"></a><span class="w">              </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(location)</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h5 id="bicep_stepsyml">bicep_steps.yml<a class="headerlink" href="#bicep_stepsyml" title="Permanent link">&para;</a></h5>
<p>This step-template will:</p>
<ol>
<li>validate that the bicep is buildable (which is converting it to a ARM Template)</li>
<li>create a resource group (no problem if called more than once and all runs belong to the same RG)</li>
<li>do some verifications if the bicep is valid and deployable</li>
<li>If conditions are met, it is calling another template to finally deploy the resources to Azure Resource Manager.</li>
</ol>
<details class="quote">
<summary>azure-pipelines/jobs/steps/bicep_steps.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span>
<span class="normal"><a href="#__codelineno-3-42">42</a></span>
<span class="normal"><a href="#__codelineno-3-43">43</a></span>
<span class="normal"><a href="#__codelineno-3-44">44</a></span>
<span class="normal"><a href="#__codelineno-3-45">45</a></span>
<span class="normal"><a href="#__codelineno-3-46">46</a></span>
<span class="normal"><a href="#__codelineno-3-47">47</a></span>
<span class="normal"><a href="#__codelineno-3-48">48</a></span>
<span class="normal"><a href="#__codelineno-3-49">49</a></span>
<span class="normal"><a href="#__codelineno-3-50">50</a></span>
<span class="normal"><a href="#__codelineno-3-51">51</a></span>
<span class="normal"><a href="#__codelineno-3-52">52</a></span>
<span class="normal"><a href="#__codelineno-3-53">53</a></span>
<span class="normal"><a href="#__codelineno-3-54">54</a></span>
<span class="normal"><a href="#__codelineno-3-55">55</a></span>
<span class="normal"><a href="#__codelineno-3-56">56</a></span>
<span class="normal"><a href="#__codelineno-3-57">57</a></span>
<span class="normal"><a href="#__codelineno-3-58">58</a></span>
<span class="normal"><a href="#__codelineno-3-59">59</a></span>
<span class="normal"><a href="#__codelineno-3-60">60</a></span>
<span class="normal"><a href="#__codelineno-3-61">61</a></span>
<span class="normal"><a href="#__codelineno-3-62">62</a></span>
<span class="normal"><a href="#__codelineno-3-63">63</a></span>
<span class="normal"><a href="#__codelineno-3-64">64</a></span>
<span class="normal"><a href="#__codelineno-3-65">65</a></span>
<span class="normal"><a href="#__codelineno-3-66">66</a></span>
<span class="normal"><a href="#__codelineno-3-67">67</a></span>
<span class="normal"><a href="#__codelineno-3-68">68</a></span>
<span class="normal"><a href="#__codelineno-3-69">69</a></span>
<span class="normal"><a href="#__codelineno-3-70">70</a></span>
<span class="normal"><a href="#__codelineno-3-71">71</a></span>
<span class="normal"><a href="#__codelineno-3-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepDir</span><span class="w"></span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)</span><span class="w"></span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepTemplateDir</span><span class="w"></span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bicepParameter</span><span class="w"></span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepParameter)</span><span class="w"></span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourceGroupName</span><span class="w"></span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(resourceGroupName)</span><span class="w"></span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azureSubscription</span><span class="w"></span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(azureSubscription)</span><span class="w"></span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span><span class="w"></span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(location)</span><span class="w"></span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">az bicep build --file main.bicep</span><span class="w"></span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Bicep Linter</span><span class="w"></span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LintBicepCode</span><span class="w"></span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">    </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)/$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create_resourceGroup.yml</span><span class="w"></span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="w">    </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">      </span><span class="nt">resourceGroupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.resourceGroupName }}</span><span class="w"></span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="w">      </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.location }}</span><span class="w"></span>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureCLI@2</span><span class="w"></span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RunPreflightValidation</span><span class="w"></span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="w">    </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">succeeded()</span><span class="w"></span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run preflight validation</span><span class="w"></span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a><span class="w">      </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)/$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="w">      </span><span class="nt">scriptType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span><span class="w"></span>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">      </span><span class="nt">scriptLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inlineScript</span><span class="w"></span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">      </span><span class="nt">inlineScript</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="w">        </span><span class="no">az deployment group validate \</span><span class="w"></span>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a><span class="w">          </span><span class="no">--resource-group ${{ parameters.resourceGroupName }} \</span><span class="w"></span>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="w">          </span><span class="no">--template-file main.bicep \</span><span class="w"></span>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="w">          </span><span class="no">--parameters @main.parameters.${{parameters.bicepParameter}}.json</span><span class="w"></span>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureCLI@2</span><span class="w"></span>
<a id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RunWhatIf</span><span class="w"></span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run what-if</span><span class="w"></span>
<a id="__codelineno-3-48" name="__codelineno-3-48"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-49" name="__codelineno-3-49"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-3-50" name="__codelineno-3-50"></a><span class="w">      </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)/$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-3-51" name="__codelineno-3-51"></a><span class="w">      </span><span class="nt">scriptType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span><span class="w"></span>
<a id="__codelineno-3-52" name="__codelineno-3-52"></a><span class="w">      </span><span class="nt">scriptLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inlineScript</span><span class="w"></span>
<a id="__codelineno-3-53" name="__codelineno-3-53"></a><span class="w">      </span><span class="nt">inlineScript</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<a id="__codelineno-3-54" name="__codelineno-3-54"></a><span class="w">        </span><span class="no">az deployment group what-if \</span><span class="w"></span>
<a id="__codelineno-3-55" name="__codelineno-3-55"></a><span class="w">          </span><span class="no">--resource-group ${{ parameters.resourceGroupName }} \</span><span class="w"></span>
<a id="__codelineno-3-56" name="__codelineno-3-56"></a><span class="w">          </span><span class="no">--template-file main.bicep \</span><span class="w"></span>
<a id="__codelineno-3-57" name="__codelineno-3-57"></a><span class="w">          </span><span class="no">--parameters @main.parameters.${{parameters.bicepParameter}}.json</span><span class="w"></span>
<a id="__codelineno-3-58" name="__codelineno-3-58"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureCLI@2</span><span class="w"></span>
<a id="__codelineno-3-59" name="__codelineno-3-59"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DeployBicepFile</span><span class="w"></span>
<a id="__codelineno-3-60" name="__codelineno-3-60"></a><span class="w">    </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">and(succeeded(), in(&#39;True&#39;, variables[&#39;isMain&#39;], variables[&#39;isStable&#39;]))</span><span class="w"></span>
<a id="__codelineno-3-61" name="__codelineno-3-61"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy Bicep Template</span><span class="w"></span>
<a id="__codelineno-3-62" name="__codelineno-3-62"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-3-63" name="__codelineno-3-63"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-3-64" name="__codelineno-3-64"></a><span class="w">      </span><span class="nt">scriptType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span><span class="w"></span>
<a id="__codelineno-3-65" name="__codelineno-3-65"></a><span class="w">      </span><span class="nt">scriptLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inlineScript</span><span class="w"></span>
<a id="__codelineno-3-66" name="__codelineno-3-66"></a><span class="w">      </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(bicepDir)/$(bicepTemplateDir)</span><span class="w"></span>
<a id="__codelineno-3-67" name="__codelineno-3-67"></a><span class="w">      </span><span class="nt">inlineScript</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<a id="__codelineno-3-68" name="__codelineno-3-68"></a><span class="w">        </span><span class="no">az deployment group create \</span><span class="w"></span>
<a id="__codelineno-3-69" name="__codelineno-3-69"></a><span class="w">          </span><span class="no">--name $(Build.BuildNumber) \</span><span class="w"></span>
<a id="__codelineno-3-70" name="__codelineno-3-70"></a><span class="w">          </span><span class="no">--resource-group ${{ parameters.ResourceGroupName }} \</span><span class="w"></span>
<a id="__codelineno-3-71" name="__codelineno-3-71"></a><span class="w">          </span><span class="no">--template-file main.bicep \</span><span class="w"></span>
<a id="__codelineno-3-72" name="__codelineno-3-72"></a><span class="w">          </span><span class="no">--parameters @main.parameters.${{parameters.bicepParameter}}.json</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h5 id="create_resourcegroupyml">create_resourceGroup.yml<a class="headerlink" href="#create_resourcegroupyml" title="Permanent link">&para;</a></h5>
<p>Well, I think the headline has already explained what this step is all about <img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f64a.svg" title=":speak_no_evil:" /></p>
<details class="quote">
<summary>azure-pipelines/jobs/steps/create_resourceGroup.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourceGroupName</span><span class="w"></span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resourcegroup Name</span><span class="w"></span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azureSubscription</span><span class="w"></span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Azure Service Connection</span><span class="w"></span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span><span class="w"></span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resourcegroup Location</span><span class="w"></span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureCLI@2</span><span class="w"></span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">    </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">succeeded()</span><span class="w"></span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create RG ${{ parameters.resourceGroupName }}</span><span class="w"></span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">    </span><span class="nt">continueOnError</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.azureSubscription }}</span><span class="w"></span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">      </span><span class="nt">scriptType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span><span class="w"></span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">      </span><span class="nt">scriptLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inlineScript</span><span class="w"></span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">      </span><span class="nt">inlineScript</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">        </span><span class="no">az group create \</span><span class="w"></span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">          </span><span class="no">--name ${{ parameters.resourceGroupName }} \</span><span class="w"></span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">          </span><span class="no">--location ${{ parameters.location }}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="mkdocs-material">mkdocs-material<a class="headerlink" href="#mkdocs-material" title="Permanent link">&para;</a></h3>
<p>This pipeline is validating, building and deploying the documentation you are just looking at <img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f605.svg" title=":sweat_smile:" /></p>
<p>Validation is done with building the docs, if there is no error I suggest that everything will be fine after it is just a static website.</p>
<p>The Deployment step <code>update gh-pages</code> will only appear when the pipeline is running from <code>main</code> or <code>stable</code> branch. Thanks to a mkdocs-plugin called <code>mike</code>, both Versions of the Documentation will be available via github-pages.</p>
<details class="quote">
<summary>azure-pipelines/mkdocs-material.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span>
<span class="normal"><a href="#__codelineno-5-39">39</a></span>
<span class="normal"><a href="#__codelineno-5-40">40</a></span>
<span class="normal"><a href="#__codelineno-5-41">41</a></span>
<span class="normal"><a href="#__codelineno-5-42">42</a></span>
<span class="normal"><a href="#__codelineno-5-43">43</a></span>
<span class="normal"><a href="#__codelineno-5-44">44</a></span>
<span class="normal"><a href="#__codelineno-5-45">45</a></span>
<span class="normal"><a href="#__codelineno-5-46">46</a></span>
<span class="normal"><a href="#__codelineno-5-47">47</a></span>
<span class="normal"><a href="#__codelineno-5-48">48</a></span>
<span class="normal"><a href="#__codelineno-5-49">49</a></span>
<span class="normal"><a href="#__codelineno-5-50">50</a></span>
<span class="normal"><a href="#__codelineno-5-51">51</a></span>
<span class="normal"><a href="#__codelineno-5-52">52</a></span>
<span class="normal"><a href="#__codelineno-5-53">53</a></span>
<span class="normal"><a href="#__codelineno-5-54">54</a></span>
<span class="normal"><a href="#__codelineno-5-55">55</a></span>
<span class="normal"><a href="#__codelineno-5-56">56</a></span>
<span class="normal"><a href="#__codelineno-5-57">57</a></span>
<span class="normal"><a href="#__codelineno-5-58">58</a></span>
<span class="normal"><a href="#__codelineno-5-59">59</a></span>
<span class="normal"><a href="#__codelineno-5-60">60</a></span>
<span class="normal"><a href="#__codelineno-5-61">61</a></span>
<span class="normal"><a href="#__codelineno-5-62">62</a></span>
<span class="normal"><a href="#__codelineno-5-63">63</a></span>
<span class="normal"><a href="#__codelineno-5-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nt">trigger</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="nt">paths</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="nt">include</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docs</span><span class="w"></span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdocs.yml</span><span class="w"></span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/requirements-mkdocs-material.txt</span><span class="w"></span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/mkdocs-material</span><span class="w"></span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/mkdocs-material.yml</span><span class="w"></span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/stages/jobs/steps/build_mkdocs.yml</span><span class="w"></span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="nt">pr</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span><span class="w"></span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pythonVersion</span><span class="w"></span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Python Version to use when building MkDocs-Material</span><span class="w"></span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;3.9&#39;</span><span class="w"></span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;3.10&#39;</span><span class="w"></span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.10&#39;</span><span class="w"></span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdocsSiteDir</span><span class="w"></span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the Directory where MkDocs will be built to</span><span class="w"></span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;site&#39;</span><span class="w"></span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agentpool</span><span class="w"></span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Agent-Pool to be used</span><span class="w"></span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="w"></span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Azure</span><span class="nv"> </span><span class="s">Pipelines&#39;</span><span class="w"></span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a><span class="nt">variables</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">variables/default.yml</span><span class="w"></span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a><span class="nt">jobs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MkDocs-Material</span><span class="w"></span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a><span class="w">    </span><span class="nt">pool</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.agentpool }}</span><span class="w"></span>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stages/jobs/steps/checkout_submodules.yml</span><span class="w"></span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a><span class="w">        </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a><span class="w">          </span><span class="nt">submodule</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;src/mkdocs-material&#39;</span><span class="w"></span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a><span class="w">          </span><span class="nt">checkoutSelf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stages/jobs/steps/build_mkdocs.yml</span><span class="w"></span>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a><span class="w">        </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a><span class="w">          </span><span class="nt">pythonVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">parameters.pythonVersion</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="w"></span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a><span class="w">          </span><span class="nt">mkdocsSiteDir</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">parameters.mkdocsSiteDir</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="w"></span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a><span class="w">          </span><span class="no">git config user.name &quot;${BUILD_SOURCEVERSIONAUTHOR:-mauwii}&quot;</span><span class="w"></span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a><span class="w">          </span><span class="no">git config user.email &quot;${BUILD_REQUESTEDFOREMAIL:-mauwii@mauwii.onmicrosoft.com}&quot;</span><span class="w"></span>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a><span class="w">          </span><span class="no">deleteVersion=$(mike list | grep -m 1 ${BUILD_SOURCEBRANCHNAME})</span><span class="w"></span>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a><span class="w">          </span><span class="no">if [[ -z &quot;${deleteVersion}&quot; ]]; then</span><span class="w"></span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a><span class="w">            </span><span class="no">deleteVersion=${deleteVersion##*\(}</span><span class="w"></span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a><span class="w">            </span><span class="no">deleteVersion=${deleteVersion%\)*}</span><span class="w"></span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a><span class="w">            </span><span class="no">mike delete $deleteVersion</span><span class="w"></span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a><span class="w">          </span><span class="no">fi</span><span class="w"></span>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a><span class="w">          </span><span class="no">if [[ $ISPULLREQUEST != &quot;True&quot; ]]; then</span><span class="w"></span>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a><span class="w">            </span><span class="no">mike deploy -t &quot;$BUILD_SOURCEBRANCHNAME&quot; --update-aliases &quot;$BUILD_SOURCEBRANCHNAME.$BUILD_BUILDID&quot; &quot;$BUILD_SOURCEBRANCHNAME&quot;</span><span class="w"></span>
<a id="__codelineno-5-61" name="__codelineno-5-61"></a><span class="w">            </span><span class="no">mike set-default &quot;$BUILD_SOURCEBRANCHNAME&quot;</span><span class="w"></span>
<a id="__codelineno-5-62" name="__codelineno-5-62"></a><span class="w">          </span><span class="no">fi</span><span class="w"></span>
<a id="__codelineno-5-63" name="__codelineno-5-63"></a><span class="w">          </span><span class="no">git push origin gh-pages</span><span class="w"></span>
<a id="__codelineno-5-64" name="__codelineno-5-64"></a><span class="w">        </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;update</span><span class="nv"> </span><span class="s">gh-pages&#39;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h4 id="build_mkdocsyml">build_mkdocs.yml<a class="headerlink" href="#build_mkdocsyml" title="Permanent link">&para;</a></h4>
<details class="quote">
<summary>azure-pipelines/stages/jobs/steps/build_mkdocs.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span>
<span class="normal"><a href="#__codelineno-6-33">33</a></span>
<span class="normal"><a href="#__codelineno-6-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pythonVersion</span><span class="w"></span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Python Version to use</span><span class="w"></span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;3.9&#39;</span><span class="w"></span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;3.10&#39;</span><span class="w"></span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(pythonVersion)</span><span class="w"></span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdocsSiteDir</span><span class="w"></span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;site&#39;</span><span class="w"></span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UsePythonVersion@0</span><span class="w"></span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Use</span><span class="nv"> </span><span class="s">Python</span><span class="nv"> </span><span class="s">${{</span><span class="nv"> </span><span class="s">parameters.pythonVersion</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="w"></span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">      </span><span class="nt">versionSpec</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">parameters.pythonVersion</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="w"></span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">      </span><span class="nt">addToPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install --upgrade pip wheel setuptools</span><span class="w"></span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update tools</span><span class="w"></span>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">npm install --no-package-lock</span><span class="w"></span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">npm install</span><span class="w"></span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">    </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/mkdocs-material</span><span class="w"></span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install -e src/mkdocs-material</span><span class="w"></span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install MkDocs-Material</span><span class="w"></span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install -r requirements.txt</span><span class="w"></span>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install requirements</span><span class="w"></span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdocs build --site-dir ${{ parameters.mkdocsSiteDir }} --verbose</span><span class="w"></span>
<a id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build docs</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="devopsbuildagentyml">devopsbuildagent.yml<a class="headerlink" href="#devopsbuildagentyml" title="Permanent link">&para;</a></h3>
<p>This Pipeline will build a docker image of a DevOps-Agent, if you want to find out more about it's features, look <a href="https://github.com/Mauwii/DevOpsBuildAgent/blob/main/README.md">here</a></p>
<details class="quote">
<summary>azure-pipelines/devopsbuildagent.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span>
<span class="normal"><a href="#__codelineno-7-35">35</a></span>
<span class="normal"><a href="#__codelineno-7-36">36</a></span>
<span class="normal"><a href="#__codelineno-7-37">37</a></span>
<span class="normal"><a href="#__codelineno-7-38">38</a></span>
<span class="normal"><a href="#__codelineno-7-39">39</a></span>
<span class="normal"><a href="#__codelineno-7-40">40</a></span>
<span class="normal"><a href="#__codelineno-7-41">41</a></span>
<span class="normal"><a href="#__codelineno-7-42">42</a></span>
<span class="normal"><a href="#__codelineno-7-43">43</a></span>
<span class="normal"><a href="#__codelineno-7-44">44</a></span>
<span class="normal"><a href="#__codelineno-7-45">45</a></span>
<span class="normal"><a href="#__codelineno-7-46">46</a></span>
<span class="normal"><a href="#__codelineno-7-47">47</a></span>
<span class="normal"><a href="#__codelineno-7-48">48</a></span>
<span class="normal"><a href="#__codelineno-7-49">49</a></span>
<span class="normal"><a href="#__codelineno-7-50">50</a></span>
<span class="normal"><a href="#__codelineno-7-51">51</a></span>
<span class="normal"><a href="#__codelineno-7-52">52</a></span>
<span class="normal"><a href="#__codelineno-7-53">53</a></span>
<span class="normal"><a href="#__codelineno-7-54">54</a></span>
<span class="normal"><a href="#__codelineno-7-55">55</a></span>
<span class="normal"><a href="#__codelineno-7-56">56</a></span>
<span class="normal"><a href="#__codelineno-7-57">57</a></span>
<span class="normal"><a href="#__codelineno-7-58">58</a></span>
<span class="normal"><a href="#__codelineno-7-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nt">trigger</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="nt">branches</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="nt">include</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">refs/heads/main</span><span class="w"></span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update/*</span><span class="w"></span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature/*</span><span class="w"></span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">issue/*</span><span class="w"></span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">  </span><span class="nt">paths</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="nt">include</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/devopsbuildagent.yml</span><span class="w"></span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-pipelines/stages/jobs/build_devopsbuildagent_job.yml</span><span class="w"></span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/DevOpsBuildAgent</span><span class="w"></span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="nt">pr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"></span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="nt">variables</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">baseOS</span><span class="w"></span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;linux&#39;</span><span class="w"></span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">baseDistro</span><span class="w"></span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;ubuntu&#39;</span><span class="w"></span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">baseVersion</span><span class="w"></span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;20.04&#39;</span><span class="w"></span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockerRegistry</span><span class="w"></span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;docker.io&#39;</span><span class="w"></span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockerhubuser</span><span class="w"></span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mauwii&#39;</span><span class="w"></span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockerimage</span><span class="w"></span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;devopsbuildagent&#39;</span><span class="w"></span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a>
<a id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matrix</span><span class="w"></span>
<a id="__codelineno-7-32" name="__codelineno-7-32"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w"></span>
<a id="__codelineno-7-33" name="__codelineno-7-33"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Object which defines the matrix strategy</span><span class="w"></span>
<a id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-35" name="__codelineno-7-35"></a><span class="w">      </span><span class="nt">amd64</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-36" name="__codelineno-7-36"></a><span class="w">        </span><span class="nt">baseArch</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;amd64&#39;</span><span class="w"></span>
<a id="__codelineno-7-37" name="__codelineno-7-37"></a><span class="w">        </span><span class="nt">targetProc</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;x64&#39;</span><span class="w"></span>
<a id="__codelineno-7-38" name="__codelineno-7-38"></a><span class="w">      </span><span class="nt">arm64v8</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-39" name="__codelineno-7-39"></a><span class="w">        </span><span class="nt">baseArch</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;arm64v8&#39;</span><span class="w"></span>
<a id="__codelineno-7-40" name="__codelineno-7-40"></a><span class="w">        </span><span class="nt">targetProc</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;arm64&#39;</span><span class="w"></span>
<a id="__codelineno-7-41" name="__codelineno-7-41"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxParallelJobs</span><span class="w"></span>
<a id="__codelineno-7-42" name="__codelineno-7-42"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number</span><span class="w"></span>
<a id="__codelineno-7-43" name="__codelineno-7-43"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Defines how many Jobs can be running in parallel by the matrix strategy</span><span class="w"></span>
<a id="__codelineno-7-44" name="__codelineno-7-44"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-7-45" name="__codelineno-7-45"></a>
<a id="__codelineno-7-46" name="__codelineno-7-46"></a><span class="nt">stages</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-47" name="__codelineno-7-47"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span><span class="w"></span>
<a id="__codelineno-7-48" name="__codelineno-7-48"></a><span class="w">    </span><span class="nt">jobs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-49" name="__codelineno-7-49"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stages/jobs/build_devopsbuildagent_job.yml</span><span class="w"></span>
<a id="__codelineno-7-50" name="__codelineno-7-50"></a><span class="w">        </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-51" name="__codelineno-7-51"></a><span class="w">          </span><span class="nt">matrix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.matrix }}</span><span class="w"></span>
<a id="__codelineno-7-52" name="__codelineno-7-52"></a><span class="w">          </span><span class="nt">maxParallelJobs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.maxParallelJobs }}</span><span class="w"></span>
<a id="__codelineno-7-53" name="__codelineno-7-53"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">manifest</span><span class="w"></span>
<a id="__codelineno-7-54" name="__codelineno-7-54"></a><span class="w">    </span><span class="nt">dependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span><span class="w"></span>
<a id="__codelineno-7-55" name="__codelineno-7-55"></a><span class="w">    </span><span class="nt">jobs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-56" name="__codelineno-7-56"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stages/jobs/pushManifest_job.yml</span><span class="w"></span>
<a id="__codelineno-7-57" name="__codelineno-7-57"></a><span class="w">        </span><span class="nt">parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-58" name="__codelineno-7-58"></a><span class="w">          </span><span class="nt">matrix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.matrix }}</span><span class="w"></span>
<a id="__codelineno-7-59" name="__codelineno-7-59"></a><span class="w">          </span><span class="nt">maxParallelJobs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.maxParallelJobs }}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="cleanup_automationyml">cleanup_automation.yml<a class="headerlink" href="#cleanup_automationyml" title="Permanent link">&para;</a></h3>
<details class="warning">
<summary>Necessary to use this Pipeline is a Service Principal with permission to delete Resources and Resource Locks</summary>
<p>Besides a Service Connection in DevOps, add Secret Variables to the Pipeline for:</p>
<ul>
<li>ApplicationId</li>
<li>ClientSecret</li>
<li>SpTenantId</li>
</ul>
</details>
<p>This Pipeline will delete Resources in Subscriptions of the used Service Principal automatically. It differs between Resources which where available before and after a initial Date, which will have a defined range of days from creation before they will be deleted. While date is not reach, it will set a Tag on the Resource with the deletion date (which is just used for information). After the Resource has reached the defined age it will be deleted.</p>
<details class="quote">
<summary>azure-pipelines/cleanup_automation.yml</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nt">trigger</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"></span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="nt">pr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"></span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="nt">schedules</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&#39;</span><span class="w"></span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Daily cleanup</span><span class="w"></span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">      </span><span class="nt">include</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span><span class="w"></span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzurePowerShell@5</span><span class="w"></span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">      </span><span class="nt">azureSubscription</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mngmtgrp001&#39;</span><span class="w"></span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">      </span><span class="nt">ScriptType</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;FilePath&#39;</span><span class="w"></span>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="w">      </span><span class="nt">azurePowerShellVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;LatestVersion&#39;</span><span class="w"></span>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">      </span><span class="nt">pwsh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="w">      </span><span class="nt">ScriptPath</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;scripts/cleanupautomation.ps1&#39;</span><span class="w"></span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="w">      </span><span class="nt">ApplicationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(ApplicationId)</span><span class="w"></span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="w">      </span><span class="nt">ClientSecret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(ClientSecret)</span><span class="w"></span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="w">      </span><span class="nt">SpTenantId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(TenantId)</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</details>
<details class="quote">
<summary>scripts/cleanupautomation.ps1</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">  1</a></span>
<span class="normal"><a href="#__codelineno-9-2">  2</a></span>
<span class="normal"><a href="#__codelineno-9-3">  3</a></span>
<span class="normal"><a href="#__codelineno-9-4">  4</a></span>
<span class="normal"><a href="#__codelineno-9-5">  5</a></span>
<span class="normal"><a href="#__codelineno-9-6">  6</a></span>
<span class="normal"><a href="#__codelineno-9-7">  7</a></span>
<span class="normal"><a href="#__codelineno-9-8">  8</a></span>
<span class="normal"><a href="#__codelineno-9-9">  9</a></span>
<span class="normal"><a href="#__codelineno-9-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-9-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-9-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-9-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-9-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-9-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-9-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-9-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-9-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-9-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-9-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-9-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-9-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-9-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-9-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-9-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-9-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-9-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-9-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-9-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-9-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-9-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-9-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-9-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-9-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-9-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-9-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-9-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-9-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-9-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-9-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-9-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-9-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-9-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-9-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-9-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-9-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-9-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-9-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-9-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-9-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-9-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-9-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-9-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-9-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-9-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-9-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-9-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-9-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-9-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-9-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-9-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-9-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-9-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-9-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-9-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-9-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-9-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-9-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-9-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-9-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-9-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-9-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-9-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-9-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-9-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-9-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-9-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-9-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-9-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-9-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-9-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-9-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-9-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-9-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-9-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-9-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-9-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-9-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-9-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-9-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-9-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-9-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-9-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-9-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-9-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-9-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-9-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-9-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-9-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-9-100">100</a></span>
<span class="normal"><a href="#__codelineno-9-101">101</a></span>
<span class="normal"><a href="#__codelineno-9-102">102</a></span>
<span class="normal"><a href="#__codelineno-9-103">103</a></span>
<span class="normal"><a href="#__codelineno-9-104">104</a></span>
<span class="normal"><a href="#__codelineno-9-105">105</a></span>
<span class="normal"><a href="#__codelineno-9-106">106</a></span>
<span class="normal"><a href="#__codelineno-9-107">107</a></span>
<span class="normal"><a href="#__codelineno-9-108">108</a></span>
<span class="normal"><a href="#__codelineno-9-109">109</a></span>
<span class="normal"><a href="#__codelineno-9-110">110</a></span>
<span class="normal"><a href="#__codelineno-9-111">111</a></span>
<span class="normal"><a href="#__codelineno-9-112">112</a></span>
<span class="normal"><a href="#__codelineno-9-113">113</a></span>
<span class="normal"><a href="#__codelineno-9-114">114</a></span>
<span class="normal"><a href="#__codelineno-9-115">115</a></span>
<span class="normal"><a href="#__codelineno-9-116">116</a></span>
<span class="normal"><a href="#__codelineno-9-117">117</a></span>
<span class="normal"><a href="#__codelineno-9-118">118</a></span>
<span class="normal"><a href="#__codelineno-9-119">119</a></span>
<span class="normal"><a href="#__codelineno-9-120">120</a></span>
<span class="normal"><a href="#__codelineno-9-121">121</a></span>
<span class="normal"><a href="#__codelineno-9-122">122</a></span>
<span class="normal"><a href="#__codelineno-9-123">123</a></span>
<span class="normal"><a href="#__codelineno-9-124">124</a></span>
<span class="normal"><a href="#__codelineno-9-125">125</a></span>
<span class="normal"><a href="#__codelineno-9-126">126</a></span>
<span class="normal"><a href="#__codelineno-9-127">127</a></span>
<span class="normal"><a href="#__codelineno-9-128">128</a></span>
<span class="normal"><a href="#__codelineno-9-129">129</a></span>
<span class="normal"><a href="#__codelineno-9-130">130</a></span>
<span class="normal"><a href="#__codelineno-9-131">131</a></span>
<span class="normal"><a href="#__codelineno-9-132">132</a></span>
<span class="normal"><a href="#__codelineno-9-133">133</a></span>
<span class="normal"><a href="#__codelineno-9-134">134</a></span>
<span class="normal"><a href="#__codelineno-9-135">135</a></span>
<span class="normal"><a href="#__codelineno-9-136">136</a></span>
<span class="normal"><a href="#__codelineno-9-137">137</a></span>
<span class="normal"><a href="#__codelineno-9-138">138</a></span>
<span class="normal"><a href="#__codelineno-9-139">139</a></span>
<span class="normal"><a href="#__codelineno-9-140">140</a></span>
<span class="normal"><a href="#__codelineno-9-141">141</a></span>
<span class="normal"><a href="#__codelineno-9-142">142</a></span>
<span class="normal"><a href="#__codelineno-9-143">143</a></span>
<span class="normal"><a href="#__codelineno-9-144">144</a></span>
<span class="normal"><a href="#__codelineno-9-145">145</a></span>
<span class="normal"><a href="#__codelineno-9-146">146</a></span>
<span class="normal"><a href="#__codelineno-9-147">147</a></span>
<span class="normal"><a href="#__codelineno-9-148">148</a></span>
<span class="normal"><a href="#__codelineno-9-149">149</a></span>
<span class="normal"><a href="#__codelineno-9-150">150</a></span>
<span class="normal"><a href="#__codelineno-9-151">151</a></span>
<span class="normal"><a href="#__codelineno-9-152">152</a></span>
<span class="normal"><a href="#__codelineno-9-153">153</a></span>
<span class="normal"><a href="#__codelineno-9-154">154</a></span>
<span class="normal"><a href="#__codelineno-9-155">155</a></span>
<span class="normal"><a href="#__codelineno-9-156">156</a></span>
<span class="normal"><a href="#__codelineno-9-157">157</a></span>
<span class="normal"><a href="#__codelineno-9-158">158</a></span>
<span class="normal"><a href="#__codelineno-9-159">159</a></span>
<span class="normal"><a href="#__codelineno-9-160">160</a></span>
<span class="normal"><a href="#__codelineno-9-161">161</a></span>
<span class="normal"><a href="#__codelineno-9-162">162</a></span>
<span class="normal"><a href="#__codelineno-9-163">163</a></span>
<span class="normal"><a href="#__codelineno-9-164">164</a></span>
<span class="normal"><a href="#__codelineno-9-165">165</a></span>
<span class="normal"><a href="#__codelineno-9-166">166</a></span>
<span class="normal"><a href="#__codelineno-9-167">167</a></span>
<span class="normal"><a href="#__codelineno-9-168">168</a></span>
<span class="normal"><a href="#__codelineno-9-169">169</a></span>
<span class="normal"><a href="#__codelineno-9-170">170</a></span>
<span class="normal"><a href="#__codelineno-9-171">171</a></span>
<span class="normal"><a href="#__codelineno-9-172">172</a></span>
<span class="normal"><a href="#__codelineno-9-173">173</a></span>
<span class="normal"><a href="#__codelineno-9-174">174</a></span>
<span class="normal"><a href="#__codelineno-9-175">175</a></span>
<span class="normal"><a href="#__codelineno-9-176">176</a></span>
<span class="normal"><a href="#__codelineno-9-177">177</a></span>
<span class="normal"><a href="#__codelineno-9-178">178</a></span>
<span class="normal"><a href="#__codelineno-9-179">179</a></span>
<span class="normal"><a href="#__codelineno-9-180">180</a></span>
<span class="normal"><a href="#__codelineno-9-181">181</a></span>
<span class="normal"><a href="#__codelineno-9-182">182</a></span>
<span class="normal"><a href="#__codelineno-9-183">183</a></span>
<span class="normal"><a href="#__codelineno-9-184">184</a></span>
<span class="normal"><a href="#__codelineno-9-185">185</a></span>
<span class="normal"><a href="#__codelineno-9-186">186</a></span>
<span class="normal"><a href="#__codelineno-9-187">187</a></span>
<span class="normal"><a href="#__codelineno-9-188">188</a></span>
<span class="normal"><a href="#__codelineno-9-189">189</a></span>
<span class="normal"><a href="#__codelineno-9-190">190</a></span>
<span class="normal"><a href="#__codelineno-9-191">191</a></span>
<span class="normal"><a href="#__codelineno-9-192">192</a></span>
<span class="normal"><a href="#__codelineno-9-193">193</a></span>
<span class="normal"><a href="#__codelineno-9-194">194</a></span>
<span class="normal"><a href="#__codelineno-9-195">195</a></span>
<span class="normal"><a href="#__codelineno-9-196">196</a></span>
<span class="normal"><a href="#__codelineno-9-197">197</a></span>
<span class="normal"><a href="#__codelineno-9-198">198</a></span>
<span class="normal"><a href="#__codelineno-9-199">199</a></span>
<span class="normal"><a href="#__codelineno-9-200">200</a></span>
<span class="normal"><a href="#__codelineno-9-201">201</a></span>
<span class="normal"><a href="#__codelineno-9-202">202</a></span>
<span class="normal"><a href="#__codelineno-9-203">203</a></span>
<span class="normal"><a href="#__codelineno-9-204">204</a></span>
<span class="normal"><a href="#__codelineno-9-205">205</a></span>
<span class="normal"><a href="#__codelineno-9-206">206</a></span>
<span class="normal"><a href="#__codelineno-9-207">207</a></span>
<span class="normal"><a href="#__codelineno-9-208">208</a></span>
<span class="normal"><a href="#__codelineno-9-209">209</a></span>
<span class="normal"><a href="#__codelineno-9-210">210</a></span>
<span class="normal"><a href="#__codelineno-9-211">211</a></span>
<span class="normal"><a href="#__codelineno-9-212">212</a></span>
<span class="normal"><a href="#__codelineno-9-213">213</a></span>
<span class="normal"><a href="#__codelineno-9-214">214</a></span>
<span class="normal"><a href="#__codelineno-9-215">215</a></span>
<span class="normal"><a href="#__codelineno-9-216">216</a></span>
<span class="normal"><a href="#__codelineno-9-217">217</a></span>
<span class="normal"><a href="#__codelineno-9-218">218</a></span>
<span class="normal"><a href="#__codelineno-9-219">219</a></span>
<span class="normal"><a href="#__codelineno-9-220">220</a></span>
<span class="normal"><a href="#__codelineno-9-221">221</a></span>
<span class="normal"><a href="#__codelineno-9-222">222</a></span>
<span class="normal"><a href="#__codelineno-9-223">223</a></span>
<span class="normal"><a href="#__codelineno-9-224">224</a></span>
<span class="normal"><a href="#__codelineno-9-225">225</a></span>
<span class="normal"><a href="#__codelineno-9-226">226</a></span>
<span class="normal"><a href="#__codelineno-9-227">227</a></span>
<span class="normal"><a href="#__codelineno-9-228">228</a></span>
<span class="normal"><a href="#__codelineno-9-229">229</a></span>
<span class="normal"><a href="#__codelineno-9-230">230</a></span>
<span class="normal"><a href="#__codelineno-9-231">231</a></span>
<span class="normal"><a href="#__codelineno-9-232">232</a></span>
<span class="normal"><a href="#__codelineno-9-233">233</a></span>
<span class="normal"><a href="#__codelineno-9-234">234</a></span>
<span class="normal"><a href="#__codelineno-9-235">235</a></span>
<span class="normal"><a href="#__codelineno-9-236">236</a></span>
<span class="normal"><a href="#__codelineno-9-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">param</span><span class="p">(</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>  <span class="no">[Switch]</span><span class="nv">$WhatIf</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="p">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="c"># Connect to Azure-CLI as Service Principal</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="no">[void]</span><span class="p">(</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>  <span class="n">az</span> <span class="n">login</span> <span class="p">`</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>    <span class="p">-</span><span class="n">-service-principal</span> <span class="p">`</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>    <span class="n">-u</span> <span class="nv">$env:ApplicationId</span> <span class="p">`</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a>    <span class="n">-p</span> <span class="nv">$env:ClientSecret</span> <span class="p">`</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a>    <span class="n">-t</span> <span class="nv">$env:SpTenantId</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="p">)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="c"># Get Current UTC-Time</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="nv">$CurrentUTCtime</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">ToUniversalTime</span><span class="p">()</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="c"># Set Initial Date</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="nv">$InitialDate</span> <span class="p">=</span> <span class="p">(</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a>  <span class="nb">Get-Date</span> <span class="p">`</span>
<a id="__codelineno-9-20" name="__codelineno-9-20"></a>    <span class="n">-Year</span> <span class="n">2022</span> <span class="p">`</span>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a>    <span class="n">-Month</span> <span class="n">06</span> <span class="p">`</span>
<a id="__codelineno-9-22" name="__codelineno-9-22"></a>    <span class="n">-Day</span> <span class="n">15</span>
<a id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="p">).</span><span class="n">ToUniversalTime</span><span class="p">()</span>
<a id="__codelineno-9-24" name="__codelineno-9-24"></a>
<a id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="c"># Days until Resources get deleted</span>
<a id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="nv">$NewerResourceDays</span> <span class="p">=</span> <span class="n">7</span>
<a id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="nv">$OlderResourceDays</span> <span class="p">=</span> <span class="n">14</span>
<a id="__codelineno-9-28" name="__codelineno-9-28"></a>
<a id="__codelineno-9-29" name="__codelineno-9-29"></a><span class="c"># Initialize Variables to count existing and deleted Resources/RGs</span>
<a id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="nv">$AllAzRgCount</span> <span class="p">=</span> <span class="n">0</span>
<a id="__codelineno-9-31" name="__codelineno-9-31"></a><span class="nv">$DeletedAzRgCount</span> <span class="p">=</span> <span class="n">0</span>
<a id="__codelineno-9-32" name="__codelineno-9-32"></a><span class="nv">$AllAzResourceCount</span> <span class="p">=</span> <span class="n">0</span>
<a id="__codelineno-9-33" name="__codelineno-9-33"></a><span class="nv">$DeletedAzResourceCount</span> <span class="p">=</span> <span class="n">0</span>
<a id="__codelineno-9-34" name="__codelineno-9-34"></a>
<a id="__codelineno-9-35" name="__codelineno-9-35"></a><span class="c"># Function to Print Information</span>
<a id="__codelineno-9-36" name="__codelineno-9-36"></a><span class="k">function</span> <span class="nb">Write-Info</span> <span class="p">{</span>
<a id="__codelineno-9-37" name="__codelineno-9-37"></a>  <span class="k">param</span> <span class="p">(</span>
<a id="__codelineno-9-38" name="__codelineno-9-38"></a>    <span class="no">[System.String]</span><span class="nv">$Title</span><span class="p">,</span>
<a id="__codelineno-9-39" name="__codelineno-9-39"></a>    <span class="no">[System.String]</span><span class="nv">$Value</span><span class="p">,</span>
<a id="__codelineno-9-40" name="__codelineno-9-40"></a>    <span class="no">[Switch]</span><span class="nv">$InitialNewLine</span><span class="p">,</span>
<a id="__codelineno-9-41" name="__codelineno-9-41"></a>    <span class="no">[Switch]</span><span class="nv">$FinalNewLine</span>
<a id="__codelineno-9-42" name="__codelineno-9-42"></a>  <span class="p">)</span>
<a id="__codelineno-9-43" name="__codelineno-9-43"></a>  <span class="nv">$Title</span> <span class="p">=</span> <span class="s2">&quot;${Title}: &quot;</span>
<a id="__codelineno-9-44" name="__codelineno-9-44"></a>  <span class="nv">$Value</span> <span class="p">=</span> <span class="s2">&quot;</span><span class="se">`t</span><span class="s2">${Value}&quot;</span>
<a id="__codelineno-9-45" name="__codelineno-9-45"></a>  <span class="k">if</span> <span class="p">(</span><span class="nv">$InitialNewLine</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-46" name="__codelineno-9-46"></a>    <span class="nv">$Title</span> <span class="p">=</span> <span class="s2">&quot;</span><span class="se">`n</span><span class="s2">${Title}&quot;</span>
<a id="__codelineno-9-47" name="__codelineno-9-47"></a>  <span class="p">}</span>
<a id="__codelineno-9-48" name="__codelineno-9-48"></a>  <span class="k">if</span> <span class="p">(</span><span class="nv">$FinalNewLine</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-49" name="__codelineno-9-49"></a>    <span class="nv">$Value</span> <span class="p">=</span> <span class="s2">&quot;${Value}</span><span class="se">`n</span><span class="s2">&quot;</span>
<a id="__codelineno-9-50" name="__codelineno-9-50"></a>  <span class="p">}</span>
<a id="__codelineno-9-51" name="__codelineno-9-51"></a>  <span class="nb">Write-Host</span> <span class="p">`</span>
<a id="__codelineno-9-52" name="__codelineno-9-52"></a>    <span class="n">-ForegroundColor</span> <span class="n">Cyan</span> <span class="p">`</span>
<a id="__codelineno-9-53" name="__codelineno-9-53"></a>    <span class="n">-NoNewline</span> <span class="p">`</span>
<a id="__codelineno-9-54" name="__codelineno-9-54"></a>    <span class="nv">$Title</span>
<a id="__codelineno-9-55" name="__codelineno-9-55"></a>  <span class="nb">Write-Host</span> <span class="nv">$Value</span>
<a id="__codelineno-9-56" name="__codelineno-9-56"></a><span class="p">}</span>
<a id="__codelineno-9-57" name="__codelineno-9-57"></a>
<a id="__codelineno-9-58" name="__codelineno-9-58"></a><span class="c"># Iterate over subscriptions</span>
<a id="__codelineno-9-59" name="__codelineno-9-59"></a><span class="k">foreach</span> <span class="p">(</span><span class="nv">$AzSubscription</span> <span class="k">in</span> <span class="nb">Get-AzSubscription</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-60" name="__codelineno-9-60"></a>
<a id="__codelineno-9-61" name="__codelineno-9-61"></a>  <span class="c"># Set Context to current Subscription</span>
<a id="__codelineno-9-62" name="__codelineno-9-62"></a>  <span class="no">[void]</span><span class="p">(</span>
<a id="__codelineno-9-63" name="__codelineno-9-63"></a>    <span class="nb">Set-AzContext</span> <span class="p">`</span>
<a id="__codelineno-9-64" name="__codelineno-9-64"></a>      <span class="n">-Subscription</span> <span class="nv">$AzSubscription</span><span class="p">.</span><span class="n">Id</span>
<a id="__codelineno-9-65" name="__codelineno-9-65"></a>  <span class="p">)</span>
<a id="__codelineno-9-66" name="__codelineno-9-66"></a>  <span class="no">[void]</span><span class="p">(</span><span class="n">az</span> <span class="n">account</span> <span class="nb">set </span><span class="p">`</span>
<a id="__codelineno-9-67" name="__codelineno-9-67"></a>      <span class="p">-</span><span class="n">-subscription</span> <span class="nv">$AzSubscription</span><span class="p">.</span><span class="n">Id</span>
<a id="__codelineno-9-68" name="__codelineno-9-68"></a>  <span class="p">)</span>
<a id="__codelineno-9-69" name="__codelineno-9-69"></a>  <span class="c"># Get Resourcegroups of current Context</span>
<a id="__codelineno-9-70" name="__codelineno-9-70"></a>  <span class="nv">$AzResourceGroups</span> <span class="p">=</span> <span class="nb">Get-AzResourceGroup</span>
<a id="__codelineno-9-71" name="__codelineno-9-71"></a>
<a id="__codelineno-9-72" name="__codelineno-9-72"></a>  <span class="c"># Add Number of ResourceGroups to AllAzRg</span>
<a id="__codelineno-9-73" name="__codelineno-9-73"></a>  <span class="nv">$AllAzRgCount</span> <span class="p">+=</span> <span class="nv">$AzResourceGroups</span><span class="p">.</span><span class="n">Length</span>
<a id="__codelineno-9-74" name="__codelineno-9-74"></a>
<a id="__codelineno-9-75" name="__codelineno-9-75"></a>  <span class="c"># Get Number of Resources in current Context</span>
<a id="__codelineno-9-76" name="__codelineno-9-76"></a>  <span class="nv">$AzResourceCount</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-AzResource</span><span class="p">).</span><span class="n">Length</span>
<a id="__codelineno-9-77" name="__codelineno-9-77"></a>
<a id="__codelineno-9-78" name="__codelineno-9-78"></a>  <span class="c"># Add Number of Resources in Subscription to AllAzResourceCount</span>
<a id="__codelineno-9-79" name="__codelineno-9-79"></a>  <span class="nv">$AllAzResourceCount</span> <span class="p">+=</span> <span class="nv">$AzResourceCount</span>
<a id="__codelineno-9-80" name="__codelineno-9-80"></a>
<a id="__codelineno-9-81" name="__codelineno-9-81"></a>  <span class="c"># Write Info to Host about current Subscription</span>
<a id="__codelineno-9-82" name="__codelineno-9-82"></a>  <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-83" name="__codelineno-9-83"></a>    <span class="n">-InitialNewLine</span> <span class="p">`</span>
<a id="__codelineno-9-84" name="__codelineno-9-84"></a>    <span class="n">-Title</span> <span class="s2">&quot;Subscription Name&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-85" name="__codelineno-9-85"></a>    <span class="n">-Value</span> <span class="nv">$AzSubscription</span><span class="p">.</span><span class="n">Name</span>
<a id="__codelineno-9-86" name="__codelineno-9-86"></a>  <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-87" name="__codelineno-9-87"></a>    <span class="n">-Title</span> <span class="s2">&quot;Resourcegroups&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-88" name="__codelineno-9-88"></a>    <span class="n">-Value</span> <span class="nv">$AzResourceGroups</span><span class="p">.</span><span class="n">Length</span>
<a id="__codelineno-9-89" name="__codelineno-9-89"></a>  <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-90" name="__codelineno-9-90"></a>    <span class="n">-Title</span> <span class="s2">&quot;Resource Count&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-91" name="__codelineno-9-91"></a>    <span class="n">-Value</span> <span class="s2">&quot;$AzResourceCount&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-92" name="__codelineno-9-92"></a>    <span class="n">-FinalNewLine</span>
<a id="__codelineno-9-93" name="__codelineno-9-93"></a>
<a id="__codelineno-9-94" name="__codelineno-9-94"></a>  <span class="c"># Iterate over Resource Groups</span>
<a id="__codelineno-9-95" name="__codelineno-9-95"></a>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$AzResourceGroup</span> <span class="k">in</span> <span class="nv">$AzResourceGroups</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-96" name="__codelineno-9-96"></a>
<a id="__codelineno-9-97" name="__codelineno-9-97"></a>    <span class="c"># Get Resources in current Resource Group</span>
<a id="__codelineno-9-98" name="__codelineno-9-98"></a>    <span class="nv">$AzResources</span> <span class="p">=</span> <span class="nb">Get-AzResource</span> <span class="p">`</span>
<a id="__codelineno-9-99" name="__codelineno-9-99"></a>      <span class="n">-ResourceGroupName</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span>
<a id="__codelineno-9-100" name="__codelineno-9-100"></a>
<a id="__codelineno-9-101" name="__codelineno-9-101"></a>    <span class="c"># Write Info to Host about Current Resource Group</span>
<a id="__codelineno-9-102" name="__codelineno-9-102"></a>    <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-103" name="__codelineno-9-103"></a>      <span class="n">-Title</span> <span class="s2">&quot;Resource Group&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-104" name="__codelineno-9-104"></a>      <span class="n">-Value</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span>
<a id="__codelineno-9-105" name="__codelineno-9-105"></a>    <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-106" name="__codelineno-9-106"></a>      <span class="n">-Title</span> <span class="s2">&quot;Resource Count&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-107" name="__codelineno-9-107"></a>      <span class="n">-Value</span> <span class="nv">$AzResources</span><span class="p">.</span><span class="n">Length</span>
<a id="__codelineno-9-108" name="__codelineno-9-108"></a>
<a id="__codelineno-9-109" name="__codelineno-9-109"></a>    <span class="c"># Iterate over Resources in current Resource Group</span>
<a id="__codelineno-9-110" name="__codelineno-9-110"></a>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$AzResource</span> <span class="k">in</span> <span class="nv">$AzResources</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-111" name="__codelineno-9-111"></a>
<a id="__codelineno-9-112" name="__codelineno-9-112"></a>      <span class="c"># Get Current Resource Creation Time</span>
<a id="__codelineno-9-113" name="__codelineno-9-113"></a>      <span class="nv">$AzCurrentResource</span> <span class="p">=</span> <span class="p">(</span>
<a id="__codelineno-9-114" name="__codelineno-9-114"></a>        <span class="n">az</span> <span class="n">resource</span> <span class="n">list</span> <span class="p">`</span>
<a id="__codelineno-9-115" name="__codelineno-9-115"></a>          <span class="p">-</span><span class="n">-location</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">Location</span> <span class="p">`</span>
<a id="__codelineno-9-116" name="__codelineno-9-116"></a>          <span class="p">-</span><span class="n">-name</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">Name</span> <span class="p">`</span>
<a id="__codelineno-9-117" name="__codelineno-9-117"></a>          <span class="p">-</span><span class="n">-query</span> <span class="s2">&quot;[].{Name:name, RG:resourceGroup, Created:createdTime, Changed:changedTime}&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-118" name="__codelineno-9-118"></a>          <span class="n">-o</span> <span class="n">json</span> <span class="p">|</span> <span class="nb">ConvertFrom-Json</span>
<a id="__codelineno-9-119" name="__codelineno-9-119"></a>      <span class="p">)</span>
<a id="__codelineno-9-120" name="__codelineno-9-120"></a>
<a id="__codelineno-9-121" name="__codelineno-9-121"></a>      <span class="c"># Check if Resource was created before or after initial date to give devs more days to react on older resources</span>
<a id="__codelineno-9-122" name="__codelineno-9-122"></a>      <span class="k">if</span> <span class="p">((</span><span class="nv">$AzCurrentResource</span><span class="p">.</span><span class="n">Created</span><span class="p">).</span><span class="n">ToUniversalTime</span><span class="p">()</span> <span class="o">-gt</span> <span class="nv">$InitialDate</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-123" name="__codelineno-9-123"></a>        <span class="nv">$DaysToDelete</span> <span class="p">=</span> <span class="nv">$NewerResourceDays</span> <span class="p">-</span> <span class="p">(</span><span class="nv">$CurrentUTCtime</span> <span class="p">-</span> <span class="p">(</span><span class="nv">$AzCurrentResource</span><span class="p">.</span><span class="n">Created</span><span class="p">).</span><span class="n">ToUniversalTime</span><span class="p">()).</span><span class="n">Days</span>
<a id="__codelineno-9-124" name="__codelineno-9-124"></a>      <span class="p">}</span>
<a id="__codelineno-9-125" name="__codelineno-9-125"></a>      <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-9-126" name="__codelineno-9-126"></a>        <span class="nv">$DaysToDelete</span> <span class="p">=</span> <span class="nv">$OlderResourceDays</span> <span class="p">-</span> <span class="p">(</span><span class="nv">$CurrentUTCtime</span> <span class="p">-</span> <span class="nv">$InitialDate</span><span class="p">).</span><span class="n">Days</span>
<a id="__codelineno-9-127" name="__codelineno-9-127"></a>      <span class="p">}</span>
<a id="__codelineno-9-128" name="__codelineno-9-128"></a>
<a id="__codelineno-9-129" name="__codelineno-9-129"></a>      <span class="c"># Add/update Tag &quot;DeletionDate&quot; of Resource, or Delete it if defined age has been reached</span>
<a id="__codelineno-9-130" name="__codelineno-9-130"></a>      <span class="k">if</span> <span class="p">(</span><span class="nv">$DaysToDelete</span> <span class="o">-gt</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-131" name="__codelineno-9-131"></a>
<a id="__codelineno-9-132" name="__codelineno-9-132"></a>        <span class="c"># Write Info to Host when Resource will be deleted</span>
<a id="__codelineno-9-133" name="__codelineno-9-133"></a>        <span class="nb">Write-Host</span> <span class="p">`</span>
<a id="__codelineno-9-134" name="__codelineno-9-134"></a>          <span class="n">-NoNewline</span> <span class="p">`</span>
<a id="__codelineno-9-135" name="__codelineno-9-135"></a>          <span class="nv">$AzCurrentResource</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="s2">&quot;will be deleted in $DaysToDelete &quot;</span>
<a id="__codelineno-9-136" name="__codelineno-9-136"></a>        <span class="k">if</span> <span class="p">(</span><span class="nv">$DaysToDelete</span> <span class="o">-gt</span> <span class="n">1</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-137" name="__codelineno-9-137"></a>          <span class="nb">Write-Host</span> <span class="s2">&quot;Days&quot;</span>
<a id="__codelineno-9-138" name="__codelineno-9-138"></a>        <span class="p">}</span>
<a id="__codelineno-9-139" name="__codelineno-9-139"></a>        <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-9-140" name="__codelineno-9-140"></a>          <span class="nb">Write-Host</span> <span class="s2">&quot;Day&quot;</span>
<a id="__codelineno-9-141" name="__codelineno-9-141"></a>        <span class="p">}</span>
<a id="__codelineno-9-142" name="__codelineno-9-142"></a>
<a id="__codelineno-9-143" name="__codelineno-9-143"></a>        <span class="c"># Set DeletionDate</span>
<a id="__codelineno-9-144" name="__codelineno-9-144"></a>        <span class="nv">$DeletionDate</span> <span class="p">=</span> <span class="nv">$CurrentUTCtime</span><span class="p">.</span><span class="n">AddDays</span><span class="p">(</span><span class="nv">$DaysToDelete</span><span class="p">)</span>
<a id="__codelineno-9-145" name="__codelineno-9-145"></a>
<a id="__codelineno-9-146" name="__codelineno-9-146"></a>        <span class="c"># Create Tag</span>
<a id="__codelineno-9-147" name="__codelineno-9-147"></a>        <span class="nv">$Tag</span> <span class="p">=</span> <span class="p">@{</span><span class="s2">&quot;DeletionDate&quot;</span> <span class="p">=</span> <span class="s2">&quot;$DeletionDate UTC&quot;</span><span class="p">;</span> <span class="p">}</span>
<a id="__codelineno-9-148" name="__codelineno-9-148"></a>        <span class="no">[void]</span><span class="p">(</span>
<a id="__codelineno-9-149" name="__codelineno-9-149"></a>          <span class="nb">Update-AzTag</span> <span class="p">`</span>
<a id="__codelineno-9-150" name="__codelineno-9-150"></a>            <span class="n">-ResourceId</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">Id</span> <span class="p">`</span>
<a id="__codelineno-9-151" name="__codelineno-9-151"></a>            <span class="n">-Tag</span> <span class="nv">$Tag</span> <span class="p">`</span>
<a id="__codelineno-9-152" name="__codelineno-9-152"></a>            <span class="n">-Operation</span> <span class="n">Merge</span> <span class="p">`</span>
<a id="__codelineno-9-153" name="__codelineno-9-153"></a>            <span class="n">-WhatIf</span><span class="p">:</span><span class="nv">$WhatIf</span>
<a id="__codelineno-9-154" name="__codelineno-9-154"></a>        <span class="p">)</span>
<a id="__codelineno-9-155" name="__codelineno-9-155"></a>      <span class="p">}</span>
<a id="__codelineno-9-156" name="__codelineno-9-156"></a>      <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-9-157" name="__codelineno-9-157"></a>        <span class="c"># Get Resource Lock</span>
<a id="__codelineno-9-158" name="__codelineno-9-158"></a>        <span class="nv">$AzResourceLock</span> <span class="p">=</span> <span class="p">(</span>
<a id="__codelineno-9-159" name="__codelineno-9-159"></a>          <span class="nb">Get-AzResourceLock</span> <span class="p">`</span>
<a id="__codelineno-9-160" name="__codelineno-9-160"></a>            <span class="n">-ResourceName</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">Name</span> <span class="p">`</span>
<a id="__codelineno-9-161" name="__codelineno-9-161"></a>            <span class="n">-ResourceType</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="nb">Type </span><span class="p">`</span>
<a id="__codelineno-9-162" name="__codelineno-9-162"></a>            <span class="n">-ResourceGroupName</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">ResourceGroupName</span>
<a id="__codelineno-9-163" name="__codelineno-9-163"></a>        <span class="p">)</span>
<a id="__codelineno-9-164" name="__codelineno-9-164"></a>        <span class="c"># Remove Resource Lock if existing</span>
<a id="__codelineno-9-165" name="__codelineno-9-165"></a>        <span class="k">if</span> <span class="p">(</span><span class="nv">$AzResourceLock</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-166" name="__codelineno-9-166"></a>          <span class="nb">Write-Host</span> <span class="s2">&quot;Deleting Resource Lock of </span><span class="p">$(</span><span class="nv">$AzResource</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&quot;</span>
<a id="__codelineno-9-167" name="__codelineno-9-167"></a>          <span class="no">[void]</span><span class="p">(</span>
<a id="__codelineno-9-168" name="__codelineno-9-168"></a>            <span class="nb">Remove-AzResourceLock</span> <span class="p">`</span>
<a id="__codelineno-9-169" name="__codelineno-9-169"></a>              <span class="n">-LockId</span> <span class="nv">$AzResourceLock</span><span class="p">.</span><span class="n">LockId</span> <span class="p">`</span>
<a id="__codelineno-9-170" name="__codelineno-9-170"></a>              <span class="n">-Force</span><span class="p">:</span><span class="nv">$true</span> <span class="p">`</span>
<a id="__codelineno-9-171" name="__codelineno-9-171"></a>              <span class="n">-WhatIf</span><span class="p">:</span><span class="nv">$WhatIf</span>
<a id="__codelineno-9-172" name="__codelineno-9-172"></a>          <span class="p">)</span>
<a id="__codelineno-9-173" name="__codelineno-9-173"></a>        <span class="p">}</span>
<a id="__codelineno-9-174" name="__codelineno-9-174"></a>        <span class="c"># Remove Resource</span>
<a id="__codelineno-9-175" name="__codelineno-9-175"></a>        <span class="nv">$RmResource</span> <span class="p">=</span> <span class="nb">Remove-AzResource</span> <span class="p">`</span>
<a id="__codelineno-9-176" name="__codelineno-9-176"></a>          <span class="n">-ResourceId</span> <span class="nv">$AzResource</span><span class="p">.</span><span class="n">Id</span> <span class="p">`</span>
<a id="__codelineno-9-177" name="__codelineno-9-177"></a>          <span class="n">-WhatIf</span><span class="p">:</span><span class="nv">$WhatIf</span> <span class="p">`</span>
<a id="__codelineno-9-178" name="__codelineno-9-178"></a>          <span class="n">-ErrorAction</span><span class="p">:</span><span class="n">SilentlyContinue</span> <span class="p">`</span>
<a id="__codelineno-9-179" name="__codelineno-9-179"></a>          <span class="n">-Force</span><span class="p">:</span><span class="nv">$true</span>
<a id="__codelineno-9-180" name="__codelineno-9-180"></a>
<a id="__codelineno-9-181" name="__codelineno-9-181"></a>        <span class="c"># Write Info and Increment Deleted Resource Count if succeeded</span>
<a id="__codelineno-9-182" name="__codelineno-9-182"></a>        <span class="k">if</span> <span class="p">(</span><span class="nv">$RmResource</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-183" name="__codelineno-9-183"></a>          <span class="nb">Write-Host</span> <span class="s2">&quot;Deleted </span><span class="p">$(</span><span class="nv">$AzResource</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&quot;</span>
<a id="__codelineno-9-184" name="__codelineno-9-184"></a>          <span class="nv">$DeletedAzResourceCount</span><span class="p">++</span>
<a id="__codelineno-9-185" name="__codelineno-9-185"></a>        <span class="p">}</span>
<a id="__codelineno-9-186" name="__codelineno-9-186"></a>        <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-9-187" name="__codelineno-9-187"></a>          <span class="nb">Write-Host</span> <span class="s2">&quot;Could not delete </span><span class="p">$(</span><span class="nv">$AzResource</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&quot;</span>
<a id="__codelineno-9-188" name="__codelineno-9-188"></a>        <span class="p">}</span>
<a id="__codelineno-9-189" name="__codelineno-9-189"></a>      <span class="p">}</span>
<a id="__codelineno-9-190" name="__codelineno-9-190"></a>    <span class="p">}</span>
<a id="__codelineno-9-191" name="__codelineno-9-191"></a>
<a id="__codelineno-9-192" name="__codelineno-9-192"></a>    <span class="c"># Get Resourcecount in current Resource Group</span>
<a id="__codelineno-9-193" name="__codelineno-9-193"></a>    <span class="nv">$AzRgResourceCount</span> <span class="p">=</span> <span class="p">(</span>
<a id="__codelineno-9-194" name="__codelineno-9-194"></a>      <span class="nb">Get-AzResource</span> <span class="p">`</span>
<a id="__codelineno-9-195" name="__codelineno-9-195"></a>        <span class="n">-ResourceGroupName</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span>
<a id="__codelineno-9-196" name="__codelineno-9-196"></a>    <span class="p">).</span><span class="n">Length</span>
<a id="__codelineno-9-197" name="__codelineno-9-197"></a>
<a id="__codelineno-9-198" name="__codelineno-9-198"></a>    <span class="c"># Delete Resourcegroup if empty</span>
<a id="__codelineno-9-199" name="__codelineno-9-199"></a>    <span class="k">if</span> <span class="p">(</span><span class="nv">$AzRgResourceCount</span> <span class="o">-eq</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-9-200" name="__codelineno-9-200"></a>      <span class="no">[void]</span><span class="p">(</span>
<a id="__codelineno-9-201" name="__codelineno-9-201"></a>        <span class="nb">Remove-AzResourceGroup</span> <span class="p">`</span>
<a id="__codelineno-9-202" name="__codelineno-9-202"></a>          <span class="n">-Name</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="p">`</span>
<a id="__codelineno-9-203" name="__codelineno-9-203"></a>          <span class="n">-Force</span><span class="p">:</span><span class="nv">$true</span> <span class="p">`</span>
<a id="__codelineno-9-204" name="__codelineno-9-204"></a>          <span class="n">-WhatIf</span><span class="p">:</span><span class="nv">$WhatIf</span>
<a id="__codelineno-9-205" name="__codelineno-9-205"></a>      <span class="p">)</span>
<a id="__codelineno-9-206" name="__codelineno-9-206"></a>      <span class="c"># Write Info to Host that ResourceGroup was deleted</span>
<a id="__codelineno-9-207" name="__codelineno-9-207"></a>      <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-208" name="__codelineno-9-208"></a>        <span class="n">-Title</span> <span class="s2">&quot;Deleted Resourcegroup&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-209" name="__codelineno-9-209"></a>        <span class="n">-Value</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="p">`</span>
<a id="__codelineno-9-210" name="__codelineno-9-210"></a>        <span class="n">-FinalNewLine</span>
<a id="__codelineno-9-211" name="__codelineno-9-211"></a>
<a id="__codelineno-9-212" name="__codelineno-9-212"></a>      <span class="c"># Increment DeletedAzRgCount</span>
<a id="__codelineno-9-213" name="__codelineno-9-213"></a>      <span class="nv">$DeletedAzRgCount</span><span class="p">++</span>
<a id="__codelineno-9-214" name="__codelineno-9-214"></a>    <span class="p">}</span>
<a id="__codelineno-9-215" name="__codelineno-9-215"></a>    <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-9-216" name="__codelineno-9-216"></a>      <span class="c"># Write Info to Host that ResourceGroup is done</span>
<a id="__codelineno-9-217" name="__codelineno-9-217"></a>      <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-218" name="__codelineno-9-218"></a>        <span class="n">-Title</span> <span class="s2">&quot;Resourcegroup Done&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-219" name="__codelineno-9-219"></a>        <span class="n">-Value</span> <span class="nv">$AzResourceGroup</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="p">`</span>
<a id="__codelineno-9-220" name="__codelineno-9-220"></a>        <span class="n">-FinalNewLine</span>
<a id="__codelineno-9-221" name="__codelineno-9-221"></a>    <span class="p">}</span>
<a id="__codelineno-9-222" name="__codelineno-9-222"></a>  <span class="p">}</span>
<a id="__codelineno-9-223" name="__codelineno-9-223"></a>
<a id="__codelineno-9-224" name="__codelineno-9-224"></a>  <span class="c"># Write Info to Host that Subscription is done</span>
<a id="__codelineno-9-225" name="__codelineno-9-225"></a>  <span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-226" name="__codelineno-9-226"></a>    <span class="n">-Title</span> <span class="s2">&quot;Subscription Done&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-227" name="__codelineno-9-227"></a>    <span class="n">-Value</span> <span class="nv">$AzSubscription</span><span class="p">.</span><span class="n">Name</span> <span class="p">`</span>
<a id="__codelineno-9-228" name="__codelineno-9-228"></a>    <span class="n">-FinalNewLine</span>
<a id="__codelineno-9-229" name="__codelineno-9-229"></a><span class="p">}</span>
<a id="__codelineno-9-230" name="__codelineno-9-230"></a>
<a id="__codelineno-9-231" name="__codelineno-9-231"></a><span class="c"># Write Info to Host about Resource-Counts</span>
<a id="__codelineno-9-232" name="__codelineno-9-232"></a><span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-233" name="__codelineno-9-233"></a>  <span class="n">-Title</span> <span class="s2">&quot;Deleted RGs&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-234" name="__codelineno-9-234"></a>  <span class="n">-Value</span> <span class="s2">&quot;</span><span class="se">`t</span><span class="s2">$DeletedAzRgCount of $AllAzRgCount&quot;</span>
<a id="__codelineno-9-235" name="__codelineno-9-235"></a><span class="nb">Write-Info</span> <span class="p">`</span>
<a id="__codelineno-9-236" name="__codelineno-9-236"></a>  <span class="n">-Title</span> <span class="s2">&quot;Deleted resources&quot;</span> <span class="p">`</span>
<a id="__codelineno-9-237" name="__codelineno-9-237"></a>  <span class="n">-Value</span> <span class="s2">&quot;$DeletedAzResourceCount of $AllAzResourceCount&quot;</span>
</code></pre></div></td></tr></table></div>
</details>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-06-27
    
  </small>
</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../1-repository/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Repository" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Repository
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Matthias Wild
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/Mauwii" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://hub.docker.com/r/mauwii/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://keybase.io/mauwi" target="_blank" rel="noopener" title="keybase.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M286.17 419a18 18 0 1 0 18 18 18 18 0 0 0-18-18zm111.92-147.6c-9.5-14.62-39.37-52.45-87.26-73.71q-9.1-4.06-18.38-7.27a78.43 78.43 0 0 0-47.88-104.13c-12.41-4.1-23.33-6-32.41-5.77-.6-2-1.89-11 9.4-35L198.66 32l-5.48 7.56c-8.69 12.06-16.92 23.55-24.34 34.89a51 51 0 0 0-8.29-1.25c-41.53-2.45-39-2.33-41.06-2.33-50.61 0-50.75 52.12-50.75 45.88l-2.36 36.68c-1.61 27 19.75 50.21 47.63 51.85l8.93.54a214 214 0 0 0-46.29 35.54C14 304.66 14 374 14 429.77v33.64l23.32-29.8a148.6 148.6 0 0 0 14.56 37.56c5.78 10.13 14.87 9.45 19.64 7.33 4.21-1.87 10-6.92 3.75-20.11a178.29 178.29 0 0 1-15.76-53.13l46.82-59.83-24.66 74.11c58.23-42.4 157.38-61.76 236.25-38.59 34.2 10.05 67.45.69 84.74-23.84.72-1 1.2-2.16 1.85-3.22a156.09 156.09 0 0 1 2.8 28.43c0 23.3-3.69 52.93-14.88 81.64-2.52 6.46 1.76 14.5 8.6 15.74 7.42 1.57 15.33-3.1 18.37-11.15C429 443 434 414 434 382.32c0-38.58-13-77.46-35.91-110.92zM142.37 128.58l-15.7-.93-1.39 21.79 13.13.78a93 93 0 0 0 .32 19.57l-22.38-1.34a12.28 12.28 0 0 1-11.76-12.79L107 119c1-12.17 13.87-11.27 13.26-11.32l29.11 1.73a144.35 144.35 0 0 0-7 19.17zm148.42 172.18a10.51 10.51 0 0 1-14.35-1.39l-9.68-11.49-34.42 27a8.09 8.09 0 0 1-11.13-1.08l-15.78-18.64a7.38 7.38 0 0 1 1.34-10.34l34.57-27.18-14.14-16.74-17.09 13.45a7.75 7.75 0 0 1-10.59-1s-3.72-4.42-3.8-4.53a7.38 7.38 0 0 1 1.37-10.34L214 225.19s-18.51-22-18.6-22.14a9.56 9.56 0 0 1 1.74-13.42 10.38 10.38 0 0 1 14.3 1.37l81.09 96.32a9.58 9.58 0 0 1-1.74 13.44zM187.44 419a18 18 0 1 0 18 18 18 18 0 0 0-18-18z"/></svg>
    </a>
  
    
    
    <a href="mailto:mauwii@outlook.de" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 5.5H9c-1.1 0-2 .9-2 2v9a2 2 0 0 0 2 2h13c1.11 0 2-.89 2-2v-9a2 2 0 0 0-2-2m0 3.67-6.5 3.33L9 9.17V7.5l6.5 3.31L22 7.5v1.67M5 16.5c0 .17.03.33.05.5H1c-.552 0-1-.45-1-1s.448-1 1-1h4v1.5M3 7h2.05c-.02.17-.05.33-.05.5V9H3c-.55 0-1-.45-1-1s.45-1 1-1m-2 5c0-.55.45-1 1-1h3v2H2c-.55 0-1-.45-1-1Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.0238f547.min.js"></script>
      
        <script src="../../js/version-select.js"></script>
      
    
  </body>
</html>